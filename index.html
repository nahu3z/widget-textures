<!DOCTYPE html>
<html>
<head>
    <style>
        body, html { margin: 0; padding: 0; overflow: hidden; background: transparent; }

        #atlas {
            display: flex;
            flex-direction: row;
            height: 100vh;
            width: max-content;
        }

        img {
            height: 100vh;
            width: auto;
            display: block;
        }
    </style>
</head>
<body>
    <div id="atlas"></div>
    <script>
        const container = document.getElementById('atlas');

        window.addEventListener("hashchange", () => {
            const hash = location.hash.substring(1);
            if (!hash) return;

            const data = hash.split(',');
            if (data[0] === "add") {
                // data[1]: URL, data[2]: ID
                addGif(decodeURIComponent(data[1]), data[2]);
            } else if (data[0] === "remove") {
                const el = document.getElementById("cont-" + data[1]);
                if (el) el.remove();
            }
            location.hash = "";
        });

        function addGif(url, id) {
            const wrapper = document.createElement('div');
            wrapper.id = "cont-" + id;
            container.appendChild(wrapper);

            const img = document.createElement('img');
            const renderH = window.innerHeight;
            img.src = `https://wsrv.nl/?url=${encodeURIComponent(url)}&h=${renderH}&n=-1`;

            img.onload = () => {
                wrapper.appendChild(img);
            };

            img.onerror = () => {
                wrapper.remove();
            };
        }
    </script>
</body>
</html>
